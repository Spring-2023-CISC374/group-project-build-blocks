var T=Object.defineProperty;var I=(l,o,e)=>o in l?T(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e;var s=(l,o,e)=>(I(l,typeof o!="symbol"?o+"":o,e),e);import"./modulepreload-polyfill.c7c6310f.js";import{C as S,a as p,P as _,b as w,B as y,c as x,d as R}from"./Crane.2cd22fa7.js";class D extends S{constructor(){super(...arguments);s(this,"visitProgram");s(this,"visitStatement");s(this,"visitLoopStatement");s(this,"visitMoveStatement");s(this,"visitActionStatement");s(this,"visitGrabAction");s(this,"visitReleaseAction")}}class E extends D{constructor(e,t){super();s(this,"output");s(this,"indent");s(this,"scene");s(this,"timing");s(this,"visitProgram",e=>{this.indent=0,this.output&&(this.output.innerHTML=""),this.visitChildren(e)});s(this,"visitStatement",e=>{this.output&&(this.output.innerHTML+=`${"&nbsp;".repeat(this.indent*4)}visitStatement ${e.getText()}<br>`),this.visitChildren(e)});s(this,"visitLoopStatement",e=>{this.output&&(this.output.innerHTML+=`${"&nbsp;".repeat(this.indent*4)}visitLoopStatement ${e.getText()}<br>`);for(let t=0;t<parseInt(e.getChild(1).getText());t++)this.visitChildren(e)});s(this,"visitActionStatement",e=>{var t,n;switch(this.output&&(this.output.innerHTML+=`${"&nbsp;".repeat(this.indent*4)}visitActionStatement ${e.getText()}<br>`),e.getText()){case"open":case"release":(t=this.scene)==null||t.time.delayedCall(this.timing,()=>{var i;(i=this.scene)==null||i.getCrane.release()}),this.timing+=p.MOVEMENT_TIME+500,console.log("open",this.timing);break;case"close":case"grab":(n=this.scene)==null||n.time.delayedCall(this.timing,()=>{var i;(i=this.scene)==null||i.getCrane.grab()}),this.timing+=p.MOVEMENT_TIME+500,console.log("close",this.timing);break}});s(this,"visitMoveStatement",e=>{var t,n,i,r,d;switch(this.output&&(this.output.innerHTML+=`${"&nbsp;".repeat(this.indent*4)}visitMoveStatement ${e.getText()}<br>`),console.log((t=this.scene)==null?void 0:t.getCrane),e.getText()){case"up":(n=this.scene)==null||n.time.delayedCall(this.timing,()=>{var a;(a=this.scene)==null||a.getCrane.moveUp()}),this.timing+=p.MOVEMENT_TIME+500,console.log("move up",this.timing);break;case"down":(i=this.scene)==null||i.time.delayedCall(this.timing,()=>{var a;(a=this.scene)==null||a.getCrane.moveDown()}),this.timing+=p.MOVEMENT_TIME+500,console.log("move down",this.timing);break;case"left":(r=this.scene)==null||r.time.delayedCall(this.timing,()=>{var a;(a=this.scene)==null||a.getCrane.moveLeft()}),this.timing+=p.MOVEMENT_TIME+500,console.log("move leftr",this.timing);break;case"right":(d=this.scene)==null||d.time.delayedCall(this.timing,()=>{var a;(a=this.scene)==null||a.getCrane.moveRight()}),this.timing+=p.MOVEMENT_TIME+500,console.log("move roigiht",this.timing);break;default:console.error("visitMoveStatement: invalid move statement",e.getText());break}console.log("visitMoveStatement",e.getText()),this.visitChildren(e)});this.indent=0,this.output=e,this.scene=t,this.timing=0}}class b extends Phaser.GameObjects.Image{constructor(e,t,n,i,r){var o=(...args)=>{super(...args);s(this,"instructionType");s(this,"instructionText");s(this,"loopChild");s(this,"loopNumber");s(this,"nextInstruction");s(this,"previousInstruction");s(this,"dropAreaLarge");s(this,"dropAreaSmall");s(this,"dropArea");s(this,"beingDragged",!1)};i==="number"&&r?(o(e,t,n,"instruction-number"),this.loopNumber=r):i==="loop"?o(e,t,n,"instruction-loop"):i==="start"?o(e,t,n,"instruction-start"):o(e,t,n,"instruction"),this.instructionText=e.make.text({x:t,y:n,text:i==="number"&&r?r.toString():i,style:{color:"black",fontSize:"18px",fixedWidth:this.width,padding:i==="number"&&r?{x:10,y:0}:{x:5,y:0}}}).setOrigin(.5,.5),this.instructionType=i,this.dropAreaLarge=new Phaser.Geom.Rectangle(0,0,this.width,this.height*2),this.dropAreaSmall=new Phaser.Geom.Rectangle(0,0,this.width,this.height),this.dropArea=this.dropAreaLarge,this.setInteractive(),e.input.setDraggable(this),this.input.dropZone=!0,this.resetTint(),this.input.hitAreaCallback=(d,a,c,g)=>{let h=g;const k=this.scene.textures.getPixelAlpha(a,c,h.texture.key);return this.nextInstruction!==void 0?k&&k>0:e.input.mousePointer.isDown&&this.scene.currentInstruction!==h&&this.scene.currentInstruction&&this.scene.currentInstruction.instructionType!=="number"?Phaser.Geom.Rectangle.Contains(h.dropArea,a,c):k&&k>0},this.on("pointerover",()=>{this.clearTint(),this.setTint(4521796)}),this.on("pointerout",()=>{this.resetTint()})}resetTint(){switch(this.clearTint(),this.instructionType){case"left":case"right":case"up":case"down":this.setTint(16756736);break;case"release":case"grab":this.setTint(6590463);break;case"number":this.setTint(7888624);break;case"loop":case"endloop":this.setTint(16670976);break;case"start":this.setTint(14427748);break}}showLinks(){if(this.instructionType==="number"||this.instructionType==="start")return;let e=this.instructionType==="loop"?"instruction-loop":"instruction";this.previousInstruction!==void 0?this.setTexture(e+"_linked"):this.setTexture(e)}moveInstruction(e,t){this.x=e,this.y=t,this.instructionText.x=e,this.instructionText.y=t,this.nextInstruction!==void 0&&this.nextInstruction.moveInstruction(e,t+31),this.loopChild!==void 0&&this.loopChild.moveInstruction(e+13,t-4),this.showLinks()}snapIntoPlace(){this.previousInstruction&&this.moveInstruction(this.previousInstruction.x,this.previousInstruction.y+31)}}class m extends _.Physics.Arcade.Sprite{constructor(e,t,n,i,r,d){super(e,t,n,i,d);s(this,"color");this.color=r,this.setColor(r),e.add.existing(this),e.physics.add.existing(this)}setColor(e){switch(this.color=e,this.color){case"brown":this.clearTint();break;case"red":this.setTint(16711680);break;case"green":this.setTint(65280);break;case"blue":this.setTint(671487);break;default:this.clearTint();break}}getColor(){return this.color}checkOverlap(e){const t=Math.abs(this.body.position.x-e.body.position.x),n=Math.abs(this.body.position.y-e.body.position.y),i=Math.sqrt(t*t+n*n);return console.log(i),i<.1}}function f(l,o,e,t){return{GRID_START_BOTTOM:l,GRID_START_LEFT:o,GRID_SQUARE_SIZE:e,GRID_END_RIGHT:o+e*t.width,GRID_END_TOP:l+e*t.height,GRID_MID_HORIZONTAL:(o+e*t.width+o)/2,GRID_MID_VERTICAL:(l+e*t.height+l)/2}}class v{constructor(o,e,t){s(this,"scene");s(this,"gridData");s(this,"isPrimaryGrid");s(this,"gridSquares");s(this,"crane");s(this,"crates");s(this,"endCrates");s(this,"toggleVisibleButton");s(this,"gridVars");s(this,"isVisible");s(this,"maxScore");this.scene=t,this.isPrimaryGrid=e,this.gridData=o,this.isPrimaryGrid?this.gridVars=f(u.P_GRID_START_BOTTOM,u.P_GRID_START_LEFT,u.P_GRID_SQUARE_SIZE,o):this.gridVars=f(u.S_GRID_START_BOTTOM,u.S_GRID_START_LEFT,u.S_GRID_SQUARE_SIZE,o),this.isVisible=!0,e&&this.getMaxScore()}getGoalText(){let o=`GOAL
`;const e=`
E = empty
C = crane
T = tan
R = Red
G = green
B = blue`,t={none:"E","crate-brown":"T","crate-red":"R","crate-green":"G","crate-blue":"B",crane:"C"};for(let n=0;n<this.gridData.gridObjectives.length;n++){for(let i=0;i<this.gridData.gridObjectives[n].length;i++)o+=(t[this.gridData.gridObjectives[n][i]]||"?")+" ";o+=`
`}return o+=e,o}makeGrid(){var o;for(let e=0;e<this.gridData.width;e++){const t=[];for(let n=0;n<this.gridData.height;n++){const i=this.scene.add.image(this.gridVars.GRID_START_LEFT+this.gridVars.GRID_SQUARE_SIZE*e,this.scene.sys.game.canvas.height-this.gridVars.GRID_START_BOTTOM-this.gridVars.GRID_SQUARE_SIZE*n,"gridSquare");t.push(i)}(o=this.gridSquares)==null||o.push(t)}this.endCrates=this.placeBlocks(!1),this.endCrates.setAlpha(.5),this.isPrimaryGrid&&(this.crates=this.placeBlocks(!0),this.toggleVisibleButton=this.scene.add.sprite(this.gridVars.GRID_MID_HORIZONTAL,this.scene.sys.game.canvas.height-(this.gridVars.GRID_END_TOP+20),"visibilityButton").setFrame(1),this.toggleVisibleButton.setInteractive(),this.toggleVisibleButton.on("pointerup",()=>{var e,t;console.log("clicked"),this.isVisible=!this.isVisible,(e=this.crates)==null||e.setVisible(this.isVisible),(t=this.toggleVisibleButton)==null||t.setFrame(this.isVisible?1:0)}),this.toggleVisibleButton.setOrigin(.8))}getMaxScore(){let o=0,e=0;for(let t=0;t<this.gridData.height;t++)for(let n=0;n<this.gridData.width;n++){const i=this.gridData.gridObjects[t][n],r=this.gridData.gridObjectives[t][n];i==="none"||i==="crane"||o++,r==="none"||r==="crane"||e++}this.maxScore=Math.min(o,e)}placeBlocks(o){const e=this.scene.physics.add.group({collideWorldBounds:!0});for(let t=0;t<this.gridData.width;t++)for(let n=this.gridData.height-1;n>=0;n--)switch(console.log("test"),o?this.gridData.gridObjects[4-n][t]:this.gridData.gridObjectives[4-n][t]){case"none":break;case"crane":{this.crane=new p(this.scene,this.gridVars.GRID_START_LEFT+this.gridVars.GRID_SQUARE_SIZE*t,this.scene.sys.game.canvas.height-this.gridVars.GRID_START_BOTTOM-this.gridVars.GRID_SQUARE_SIZE*n,!0);break}case"crate-brown":{const i=new m(this.scene,this.gridVars.GRID_START_LEFT+this.gridVars.GRID_SQUARE_SIZE*t,this.scene.sys.game.canvas.height-this.gridVars.GRID_START_BOTTOM-this.gridVars.GRID_SQUARE_SIZE*n,"regCrate","brown");o||i.setAlpha(.5),i.refreshBody(),e.add(i.setPushable(!1));break}case"crate-red":{const i=new m(this.scene,this.gridVars.GRID_START_LEFT+this.gridVars.GRID_SQUARE_SIZE*t,this.scene.sys.game.canvas.height-this.gridVars.GRID_START_BOTTOM-this.gridVars.GRID_SQUARE_SIZE*n,"regCrate","red");i.refreshBody(),e.add(i.setPushable(!1));break}case"crate-green":{const i=new m(this.scene,this.gridVars.GRID_START_LEFT+this.gridVars.GRID_SQUARE_SIZE*t,this.scene.sys.game.canvas.height-this.gridVars.GRID_START_BOTTOM-this.gridVars.GRID_SQUARE_SIZE*n,"regCrate","green");i.refreshBody(),e.add(i.setPushable(!1));break}case"crate-blue":{const i=new m(this.scene,this.gridVars.GRID_START_LEFT+this.gridVars.GRID_SQUARE_SIZE*t,this.scene.sys.game.canvas.height-this.gridVars.GRID_START_BOTTOM-this.gridVars.GRID_SQUARE_SIZE*n,"regCrate","blue");i.refreshBody(),e.add(i.setPushable(!1));break}}return this.scene.physics.add.collider(e,e),this.crane!==void 0&&o&&this.scene.physics.add.collider(this.crane,e),e}resetGrid(){var o;!this.isPrimaryGrid||(this.crane.destroy(!0),(o=this.crates)==null||o.clear(!0,!0),this.crates=this.placeBlocks(!0))}}class u extends _.Scene{constructor(e="LevelScene"){super(e);s(this,"grid");s(this,"secondaryGrid");s(this,"start_blocks",0);s(this,"left_blocks",0);s(this,"right_blocks",0);s(this,"up_blocks",0);s(this,"down_blocks",0);s(this,"grab_blocks",0);s(this,"release_blocks",0);s(this,"loop_blocks",0);s(this,"endloop_blocks",0);s(this,"number_blocks",[0]);s(this,"crates");s(this,"endCrates");s(this,"crane");s(this,"start_instruction");s(this,"score",0);s(this,"Instructions");s(this,"currentInstruction");s(this,"background")}get getCrane(){return this.crane}init(e){this.Instructions=new _.GameObjects.Container(this),this.grid=new v(e.gridData,!0,this),this.secondaryGrid=new v(e.gridData,!1,this),this.start_blocks=e.gridData.start_blocks,this.up_blocks=e.gridData.up_blocks,this.left_blocks=e.gridData.left_blocks,this.right_blocks=e.gridData.right_blocks,this.down_blocks=e.gridData.down_blocks,this.grab_blocks=e.gridData.grab_blocks,this.release_blocks=e.gridData.release_blocks,this.loop_blocks=e.gridData.loop_blocks,this.endloop_blocks=e.gridData.endloop_blocks,this.number_blocks=e.gridData.number_blocks,this.createLevel(),this.input.on("drag",this.handleDrag,this),this.input.on("drop",this.handleDrop,this)}createLevel(){this.background=this.add.image(this.sys.game.canvas.width/2,this.sys.game.canvas.height/2,"background"),this.background.setScale(this.sys.game.canvas.width,this.sys.game.canvas.height),this.grid.makeGrid(),this.crates=this.grid.crates,this.endCrates=this.grid.endCrates,this.crane=this.grid.crane,this.secondaryGrid.makeGrid();const e=document.getElementById("editor");console.log(e);const t=e.contentWindow;t.scene=this,this.generate_instructions();const n=this.add.rectangle(this.sys.game.canvas.width-80,this.sys.game.canvas.height-130,140,30,2113632,1);n.setInteractive(),n.on("pointerover",()=>{n.setFillStyle(2113632,.6)}),n.on("pointerout",()=>{n.setFillStyle(2113632,1)}),this.add.text(this.sys.game.canvas.width-80,this.sys.game.canvas.height-130,"execute!",{fontSize:"18px",color:"#fff"}).setOrigin(.5),n.on("pointerdown",()=>{console.log(this.InstructionChainToString()),this.execute(this.InstructionChainToString())});const r=this.add.rectangle(this.sys.game.canvas.width-80,this.sys.game.canvas.height-30,140,30,2113632,1);r.setInteractive(),r.on("pointerover",()=>{r.setFillStyle(2113632,.6)}),r.on("pointerout",()=>{r.setFillStyle(2113632,1)}),this.add.text(this.sys.game.canvas.width-80,this.sys.game.canvas.height-30,"main menu",{fontSize:"18px",color:"#fff"}).setOrigin(.5),r.on("pointerdown",()=>{this.scene.start("MainMenuScene")});const a=this.add.rectangle(this.sys.game.canvas.width-80,this.sys.game.canvas.height-80,140,30,2113632,1);a.setInteractive(),a.on("pointerover",()=>{a.setFillStyle(2113632,.6)}),a.on("pointerout",()=>{a.setFillStyle(2113632,1)}),this.add.text(this.sys.game.canvas.width-80,this.sys.game.canvas.height-80,"reset",{fontSize:"18px",color:"#fff"}).setOrigin(.5),a.on("pointerdown",()=>{this.grid.resetGrid(),this.crates=this.grid.crates,this.crane=this.grid.crane})}update(){this.crane!==void 0&&(this.physics.overlap(this.crane.PICKUP_BOX,this.crates,(e,t)=>{this.crane!==void 0&&(this.crane.toGrab=t)})||(this.crane.toGrab=void 0)),this.checkWin()}checkOverlap(e,t){if(e.getColor()!==t.getColor())return!1;const n=Math.abs(t.body.position.x-e.body.position.x),i=Math.abs(t.body.position.y-e.body.position.y);return Math.sqrt(n*n+i*i)<6}getScore(){var e;this.score=0,(e=this.crates)==null||e.getChildren().forEach(t=>{var n;(n=this.endCrates)==null||n.getChildren().forEach(i=>{const r=t,d=i;this.checkOverlap(d,r)&&this.score++})},this)}checkWin(){this.getScore();const e=this.score===this.grid.maxScore;return e&&(console.log("you win!"),this.add.rectangle(400,300,200,40,0),this.add.text(400,300,"YOU WIN!",{fontSize:"18px"}).setOrigin(.5,.5)),e}generate_instructions(){var r,d,a;let e=100,t=50;if(this.start_blocks>0){const c=new b(this,e,t,"start");(r=this.Instructions)==null||r.add([c,c.instructionText]),this.start_instruction=c,t+=50}const n=[this.up_blocks,this.down_blocks,this.left_blocks,this.right_blocks,this.grab_blocks,this.release_blocks,this.loop_blocks,this.endloop_blocks],i=["up","down","left","right","grab","release","loop","endloop"];for(let c=0;c<n.length;c++)for(let g=0;g<n[c];g++){const h=new b(this,e,t,i[c]);(d=this.Instructions)==null||d.add([h,h.instructionText]),t+=50,t>=400&&(e+=100,t=50)}for(let c=0;c<this.number_blocks.length;c++){const g=new b(this,e,t,"number",this.number_blocks[c]);(a=this.Instructions)==null||a.add([g,g.instructionText]),t+=50,t>=400&&(e+=100,t=50)}this.add.existing(this.Instructions)}InstructionChainToString(){var t;let e=this.start_instruction;if(this.start_instruction){let n="";for(;(e==null?void 0:e.nextInstruction)!==void 0;)e=e.nextInstruction,n+=e.instructionType,e.instructionType==="loop"&&(n+=" "+((t=e.loopChild)==null?void 0:t.loopNumber)),n+=`
`;return console.log(n),n}return""}execute(e){const t=e,n=new w(t),i=new y(n),r=new x(i),a=new R(r).program(),c=new E(null,this);console.log(c.visit(a))}handleDrag(e,t,n,i){var r;if(!(t instanceof b)){console.log(t);return}this.currentInstruction=t,(r=this.Instructions)==null||r.sendToBack(t),t.previousInstruction&&(t.instructionType==="number"?t.previousInstruction.loopChild=void 0:t.previousInstruction.nextInstruction=void 0,t.previousInstruction.dropArea=t.previousInstruction.dropAreaLarge,t.previousInstruction=void 0),t.moveInstruction(n,i)}handleDrop(e,t,n){var i,r;!(n instanceof b)||!(t instanceof b)||n instanceof b&&n!==t&&n.instructionType!=="number"&&(t.instructionType==="number"?(n.instructionType==="loop"&&n.loopChild===void 0&&(t.previousInstruction=n,t.previousInstruction.loopChild=t,t.moveInstruction(t.previousInstruction.x+13,t.previousInstruction.y-4),(i=this.Instructions)==null||i.bringToTop(t),(r=this.Instructions)==null||r.bringToTop(t.instructionText)),t.dropArea=t.dropAreaSmall):t.previousInstruction===void 0&&n.nextInstruction===void 0&&(t.previousInstruction=n,n.nextInstruction=t,t.snapIntoPlace(),n.dropArea=n.dropAreaSmall))}}s(u,"P_GRID_START_BOTTOM",16),s(u,"P_GRID_START_LEFT",16),s(u,"P_GRID_SQUARE_SIZE",32),s(u,"S_GRID_START_BOTTOM",16),s(u,"S_GRID_START_LEFT",300),s(u,"S_GRID_SQUARE_SIZE",32);class G extends _.Scene{constructor(){super({key:"LevelSelectScene"});s(this,"LEVELS",[{width:5,height:5,gridObjects:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crane","none","none"],["none","none","none","none","none"],["crate-brown","crate-brown","crate-brown","none","none"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crate-brown","none","none"],["none","none","crate-brown","none","none"],["none","none","crate-brown","none","none"]],start_blocks:1,loop_blocks:0,endloop_blocks:0,left_blocks:3,right_blocks:3,down_blocks:2,up_blocks:3,grab_blocks:2,release_blocks:2,number_blocks:[]},{width:5,height:5,gridObjects:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","crane"],["crate-brown","none","crate-brown","none","none"],["crate-brown","crate-brown","crate-brown","crate-brown","none"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["crate-brown","none","none","none","none"],["crate-brown","crate-brown","none","none","none"],["crate-brown","crate-brown","crate-brown","none","none"]],start_blocks:1,loop_blocks:0,endloop_blocks:0,left_blocks:5,right_blocks:1,down_blocks:2,up_blocks:3,grab_blocks:2,release_blocks:2,number_blocks:[]},{width:5,height:5,gridObjects:[["none","none","none","none","none"],["none","none","none","none","none"],["crane","none","none","none","none"],["none","none","none","none","none"],["crate-brown","none","none","none","crate-brown"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","crate-brown"],["none","none","none","none","crate-brown"]],start_blocks:1,loop_blocks:1,endloop_blocks:1,left_blocks:0,right_blocks:1,down_blocks:1,up_blocks:1,grab_blocks:1,release_blocks:1,number_blocks:[4]},{width:5,height:5,gridObjects:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","crane"],["none","none","none","none","none"],["crate-brown","none","none","none","crate-brown"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","crate-brown"],["none","none","none","none","crate-brown"]],start_blocks:1,loop_blocks:2,endloop_blocks:2,left_blocks:1,right_blocks:1,down_blocks:1,up_blocks:1,grab_blocks:1,release_blocks:1,number_blocks:[4,4]},{width:5,height:5,gridObjects:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crane","none","none"],["none","none","none","none","none"],["crate-red","crate-green","crate-blue","none","none"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crate-green","none","none"],["none","none","crate-red","none","none"],["none","none","crate-blue","none","none"]],start_blocks:1,loop_blocks:0,endloop_blocks:0,left_blocks:3,right_blocks:3,down_blocks:2,up_blocks:3,grab_blocks:2,release_blocks:2,number_blocks:[]},{width:5,height:5,gridObjects:[["none","none","none","none","none"],["crane","none","none","none","none"],["none","none","crate-red","none","none"],["crate-green","none","crate-red","none","crate-blue"],["crate-blue","none","crate-red","none","crate-green"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crate-red","none","none"],["none","none","crate-red","none","none"],["crate-blue","crate-blue","crate-red","crate-green","crate-green"]],start_blocks:1,loop_blocks:3,endloop_blocks:3,left_blocks:1,right_blocks:2,down_blocks:2,up_blocks:2,grab_blocks:2,release_blocks:2,number_blocks:[3,3,3]}])}create(){for(let e=0;e<this.LEVELS.length;e++){const t=this.add.rectangle(100+e%6*100,100+Math.floor(e/6)*100,80,80,2113632,1);t.setInteractive(),t.on("pointerover",()=>{t.setFillStyle(2113632,.6)}),t.on("pointerout",()=>{t.setFillStyle(2113632,1)}),this.add.text(100+e%6*100,100+Math.floor(e/6)*100,`${e+1}`,{fontSize:"40px",color:"#fff"}).setOrigin(.5),t.on("pointerdown",()=>{console.log(`level ${e} clicked`),this.scene.start("LevelScene",{levelNumber:e,gridData:this.LEVELS[e]})})}}}class C extends u{constructor(){super("TutorialLevelScene");s(this,"tutLevelData",{width:5,height:5,gridObjects:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crane","none","none"],["none","none","none","none","none"],["crate-brown","none","none","none","none"]],gridObjectives:[["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","none"],["none","none","none","none","none"],["none","none","crate-brown","none","none"]],start_blocks:0,loop_blocks:0,endloop_blocks:0,left_blocks:0,right_blocks:0,down_blocks:0,up_blocks:0,grab_blocks:0,release_blocks:0,number_blocks:[]});s(this,"loop_instruction");s(this,"grab_instruction");s(this,"release_instruction");s(this,"endloop_instruction");s(this,"up_instruction");s(this,"down_instruction");s(this,"right_instruction");s(this,"left1_instruction");s(this,"left2_instruction");s(this,"number_instruction")}init(){super.init({levelNumber:-1,gridData:this.tutLevelData})}create(){const e=[`Welcome to the tutorial level!

		Below this text are two grids, the left grid is the actual play area
		The right grid is what you need to make the play area look like
	
		Click here to continue.
		`,`
		Inside the play grid are crates and a crane.
	
		You can control the crane by dragging and dropping instructions in a list.
	
		The instructions will be done from top to bottom starting with the start block.
	
		Click here to continue.
		`,`left, down, up, and right move the crane one tile in that direction.
	
		grab blocks attach the crate directly below the crane to the crane.
	
		release drops whatever crate the crane is currently holding.
	
		Click here to continue
		`,`
		loop and endloop instructions are special.
	
		Every loop needs a number and an endloop.
	
		numbers go in the loop block and endloops come after.
	
		every instruction between the loop and endloop is done multiple times 
		equal to the number in the loop block.
	
		Click here to continue.
		`,`
		Complete the level by arranging the instructions after start.
	
		Click the execute button to make the crane follow instructions.
	
		Click restart to restart the level.
	
		Click main menu to go back to the main menu.
	
		Good luck!
	
		Click here to dismiss this text.
		`],t=this.add.text(400,300,e.shift(),{fontFamily:"Arial",fontSize:"24px",color:"#FFFFFF",align:"center",backgroundColor:"black",fixedWidth:this.game.canvas.width}).setOrigin(.5,.5);t.setInteractive(),t.on("pointerdown",()=>{const n=e.shift();n?t.setText(n):t.destroy()}),this.makeInstructions()}update(){super.update()}makeInstructions(){var d,a;let e=100,t=50;const n=[1,1,1,2,1,1,1,1,1],i=["start","up","down","left","right","grab","release","loop","endloop"];for(let c=0;c<n.length;c++)for(let g=0;g<n[c];g++){const h=new b(this,e,t,i[c]);(d=this.Instructions)==null||d.add([h,h.instructionText]),t+=50,t>=400&&(e+=100,t=50),i[c]==="start"?this.start_instruction=h:i[c]==="up"?this.up_instruction=h:i[c]==="down"?this.down_instruction=h:i[c]==="right"?this.right_instruction=h:i[c]==="left"?g===0?this.left1_instruction=h:this.left2_instruction=h:i[c]==="loop"?this.loop_instruction=h:i[c]==="endloop"?this.endloop_instruction=h:i[c]==="grab"?this.grab_instruction=h:i[c]==="release"&&(this.release_instruction=h)}const r=new b(this,e,t,"number",2);(a=this.Instructions)==null||a.add([r,r.instructionText]),this.number_instruction=r}}class A extends Phaser.Scene{constructor(){super({key:"MainMenuScene"})}preload(){this.load.image("background","assets/TempBackground.png"),this.load.image("gridSquare","assets/GridSquare.png"),this.load.image("regCrate","assets/RegCrate.png"),this.load.image("craneOpen","assets/CraneBasicRed.png"),this.load.image("craneClosed","assets/CraneBasicGreen.png"),this.load.image("cranePickupBox","assets/CranePickupBox.png"),this.load.spritesheet("visibilityButton","assets/VisibilityButtons.png",{frameWidth:48,frameHeight:32}),this.load.image("instruction","assets/Instruction.png"),this.load.image("instruction-start","assets/StartInstruction.png"),this.load.image("instruction_linked","assets/Instruction_linked.png"),this.load.image("instruction-loop","assets/LoopInstruction.png"),this.load.image("instruction-loop_linked","assets/LoopInstruction_linked.png"),this.load.image("instruction-number","assets/Instruction-number.png")}create(){this.add.text(this.game.config.width/2,100,"Build Blocks",{fontSize:"64px"}).setOrigin(.5);const e=this.add.rectangle(this.game.config.width/2,300,300,50,2113632);e.setInteractive(),e.on("pointerdown",()=>{this.scene.start("TutorialLevelScene")}),e.on("pointerover",()=>{e.setFillStyle(2113632,.6)}),e.on("pointerout",()=>{e.setFillStyle(2113632,1)}),this.add.text(this.game.config.width/2,300,"Tutorial Level",{fontSize:"32px"}).setOrigin(.5);const n=this.add.rectangle(this.game.config.width/2,400,300,50,2113632);n.setInteractive(),n.on("pointerdown",()=>{this.scene.start("LevelSelectScene")}),n.on("pointerover",()=>{n.setFillStyle(2113632,.6)}),n.on("pointerout",()=>{n.setFillStyle(2113632,1)}),this.add.text(this.game.config.width/2,400,"Level Select",{fontSize:"32px"}).setOrigin(.5)}}const O={type:_.AUTO,parent:"app",width:800,height:600,physics:{default:"arcade",arcade:{gravity:{y:300}}},scene:[A,G,C,u]};new _.Game(O);
